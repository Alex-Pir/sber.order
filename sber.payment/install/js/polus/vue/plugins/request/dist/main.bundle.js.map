{"version":3,"file":"main.bundle.js","sources":["../src/request.js"],"sourcesContent":["\"use strict\"\n\nimport {Vue} from \"ui.vue\";\n\nlet Request = function() {\n    this.data = null;\n    this.signedParameters = null;\n    this.options = null;\n    this.url = null;\n};\n\nRequest.prototype.setSignedParameters = function(parameters) {\n    this.signedParameters = parameters;\n    return this;\n}\n\nRequest.prototype.setData = function(data) {\n    this.data = data;\n    return this;\n}\n\nRequest.prototype.setOptions = function(options) {\n    this.options = options;\n    return this;\n}\n\nRequest.prototype.setUrl = function(url) {\n    this.url = url;\n    return this;\n}\n\nRequest.prototype.send = function(componentMethod = null) {\n    let url = this.url;\n    let data = this.data;\n\n    return new Promise((resolve, reject) => {\n        let result = componentMethod !== null\n            ? this.sendToComponent(url, data, componentMethod)\n            : this.sendToModule(url, data);\n\n        result.then(response => {\n            if (response.status === \"success\" && response.hasOwnProperty(\"data\")) {\n                resolve(response.data);\n            } else {\n                reject(response);\n            }\n        })\n        .catch(error => {\n            if (error.hasOwnProperty(\"errors\")) {\n                let resultMessage = [];\n                const errors = error.errors;\n\n                for (let i in errors) {\n                    resultMessage.push(errors[i].message);\n                }\n\n                reject(resultMessage.join('</br>'));\n            } else {\n                reject(error);\n            }\n        });\n    });\n}\n\nRequest.prototype.sendToModule = function(url, data) {\n    return BX.ajax.runAction(\n        url,\n        {\n            data: data,\n            preparePost: true,\n            enctype: 'multipart/form-data'\n        }\n    );\n}\n\nRequest.prototype.sendToComponent = function(url, data, componentMethod) {\n    return BX.ajax.runComponentAction(\n        url,\n        componentMethod,\n        {\n            data: data,\n            mode: 'class',\n            //enctype: 'multipart/form-data',\n            signedParameters: this.signedParameters\n        }\n    );\n}\n\nRequest.install = function(Vue, options) {\n    Vue.prototype.$request = new Request();\n}\n\nVue.use(Request);\n\nexport default Request;"],"names":["Request","data","signedParameters","options","url","prototype","setSignedParameters","parameters","setData","setOptions","setUrl","send","_this","componentMethod","arguments","length","Promise","resolve","reject","result","sendToModule","sendToComponent","then","response","status","hasOwnProperty","error","resultMessage","errors","i","push","message","join","BX","ajax","runAction","preparePost","enctype","runComponentAction","mode","install","Vue","$request","use"],"mappings":"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"}